# 人工智能小项目
本项目是南京大学——智能科学与技术专业——人工智能导论课程小组大作业
## 项目开发环境简介
项目语言：C++

游戏本体框架：Qt 6.5.0

AI部分框架：Libtorch 2.1.0 + cuda:11.8

开发环境：Visual Studio 2022

## 幸存者游戏环境简介  
游戏基于先前开源CPP项目并作出简化：目标存活时间为60s，不启用升级系统，提高角色初始等级

为了实现环境的逐步运行，重构了游戏内计时器，采用主计时器定期发送信号的模式

游戏环境经过封装，环境接口格式仿照gym

## 环境预处理
跳帧:运行帧率:100fps to 20fps;	同时适当降低操作频率，每四帧操作一次，4帧共用一个动作

图像灰度化+帧堆叠:将过去3帧的图片打包成一组输入，让输入在保持规模的情况下能保留一定的时间信息

简化角色贴图，降低分辨率（1920 * 1080  ->  192 * 108)

## DRL算法
采用Rainbow DQN算法，Distributional——DQN部分采用基础的基于c51的算法

由于算法是从朴素DQN逐步升级，因此代码也残留了诸多被注释掉的内容，这些基本是在某一个trick应用前的残留代码，也权当一个参考了

神经网络给出两种结构，分别使用CNN和ResNet，分别对应单一种子训练和多种子训练的成果（见“模型使用”）

ResNet和NoisyNet的实现参考的代码连接已经附在注释当中
## 模型使用
模型只保留了参数，因此加载模型需要在源码里指定网络的类来选取对应的网络结构才行

例如使用A类结构，则要在agent类中修改q_net、target_q_net的声明，例如 “A q_net,target_q_net;”

程序默认读取模型路径为根目录下model文件夹的model.pt文件，可在main.cpp中自行修改PATH更改

目前提供两个模型：

model_141.pt是单种子（114514）下的表现不错的模型，采用的类是neuro_net_v1

model_86.48_95.28是多种子下表现不错的模型，采用的类是neuro_net

模型可以进行检测和二次训练，在main.cpp中修改主函数流程即可
